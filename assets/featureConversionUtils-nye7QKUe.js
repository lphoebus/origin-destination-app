import{cX as sr,cY as P,cZ as ur,c_ as lr,c$ as cr,bf as ir,b4 as z,d0 as fr,d1 as ar,d2 as hr,d3 as F,d4 as v,d5 as dr,d6 as gr}from"./index-Bkom2Sdc.js";function w(r,n){return r?n?4:3:n?3:2}const L=()=>ir.getLogger("esri.layers.graphics.featureConversionUtils"),A={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},yr=(r,n,o,e,u,t)=>{r[o]=u,r[o+1]=t},B=(r,n,o,e,u,t)=>{r[o]=u,r[o+1]=t,r[o+2]=n[e+2]},mr=(r,n,o,e,u,t)=>{r[o]=u,r[o+1]=t,r[o+2]=n[e+3]},pr=(r,n,o,e,u,t)=>{r[o]=u,r[o+1]=t,r[o+2]=n[e+2],r[o+3]=n[e+3]};function C(r,n,o,e){if(r){if(o)return n&&e?pr:B;if(n&&e)return mr}else if(n&&e)return B;return yr}function Y({scale:r,translate:n},o){return Math.round((o-n[0])/r[0])}function _({scale:r,translate:n},o){return Math.round((n[1]-o)/r[1])}function R({scale:r,translate:n},o){return Math.round((o-n[0])/r[0])}function S({scale:r,translate:n},o){return Math.round((o-n[1])/r[1])}function V({scale:r,translate:n},o,e){return o*r[e]+n[e]}function Sr(r,n,o){return r?n?o?X(r):O(r):o?D(r):U(r):null}function U(r){const n=r.coords;return{x:n[0],y:n[1]}}function K(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r}function O(r){const n=r.coords;return{x:n[0],y:n[1],z:n[2]}}function wr(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r.coords[2]=n.z,r}function D(r){const n=r.coords;return{x:n[0],y:n[1],m:n[2]}}function Mr(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r.coords[2]=n.m,r}function X(r){const n=r.coords;return{x:n[0],y:n[1],z:n[2],m:n[3]}}function Gr(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r.coords[2]=n.z,r.coords[3]=n.m,r}function br(r,n,o,e){let u=U;o&&e?u=X:o?u=O:e&&(u=D);for(const t of n){const{geometry:s,attributes:l}=t,i=s!=null?u(s):null;r.push({attributes:l,geometry:i})}return r}function j(r,n){return r&&n?Gr:r?wr:n?Mr:K}function Pr(r,n,o,e,u){const t=j(o,e);for(const s of n){const l=s.geometry!=null?t(new P,s.geometry):null;r.push(new v(l,s.attributes,null,F(s,u)))}return r}function Tr(r,n,o=j(n.z!=null,n.m!=null)){return o(r,n)}function Ir(r,n,o,e){for(const{geometry:u,attributes:t}of n)r.push({attributes:t,geometry:u!=null?Q(u,o,e):null});return r}function Q(r,n,o){if(r==null)return null;const e=w(n,o),u=[];for(let t=0;t<r.coords.length;t+=e){const s=[];for(let l=0;l<e;l++)s.push(r.coords[t+l]);u.push(s)}return n?o?{points:u,hasZ:n,hasM:o}:{points:u,hasZ:n}:o?{points:u,hasM:o}:{points:u}}function Zr(r,n,o,e,u){const t=w(o,e);for(const s of n){const l=s.geometry!=null?W(new P,s.geometry,t):null;r.push(new v(l,s.attributes,null,F(s,u)))}return r}function W(r,n,o=w(n.hasZ,n.hasM)){r.lengths[0]=n.points.length;const e=r.coords;let u=0;for(const t of n.points)for(let s=0;s<o;s++)e[u++]=t[s];return r}function Nr(r,n,o,e){for(const{geometry:u,attributes:t}of n)r.push({attributes:t,geometry:u!=null?$(u,o,e):null});return r}function $(r,n,o){if(!r)return null;const e=w(n,o),{coords:u,lengths:t}=r,s=[];let l=0;for(const i of t){const c=[];for(let f=0;f<i;f++){const a=[];for(let h=0;h<e;h++)a.push(u[l++]);c.push(a)}s.push(c)}return n?o?{paths:s,hasZ:n,hasM:o}:{paths:s,hasZ:n}:o?{paths:s,hasM:o}:{paths:s}}function xr(r,n,o,e,u){const t=w(o,e);for(const s of n){const l=s.geometry!=null?rr(new P,s.geometry,t):null,i=s.centroid!=null?Tr(new P,s.centroid):null;r.push(new v(l,s.attributes,i,F(s,u)))}return r}function rr(r,n,o=w(n.hasZ,n.hasM)){const{lengths:e,coords:u}=r;let t=0;for(const s of n.paths){for(const l of s)for(let i=0;i<o;i++)u[t++]=l[i];e.push(s.length)}return r}function kr(r,n,o,e){for(const{geometry:u,attributes:t,centroid:s}of n){const l=u!=null?nr(u,o,e):null;if(s!=null){const i=U(s);r.push({attributes:t,centroid:i,geometry:l})}else r.push({attributes:t,geometry:l})}return r}function nr(r,n,o){if(!r)return null;const e=w(n,o),{coords:u,lengths:t}=r,s=[];let l=0;for(const i of t){const c=[];for(let f=0;f<i;f++){const a=[];for(let h=0;h<e;h++)a.push(u[l++]);c.push(a)}s.push(c)}return n?o?{rings:s,hasZ:n,hasM:o}:{rings:s,hasZ:n}:o?{rings:s,hasM:o}:{rings:s}}function vr(r,n,o,e,u){for(const t of n){const s=t.geometry!=null?or(new P,t.geometry,o,e):null,l=F(t,u);t.centroid!=null?r.push(new v(s,t.attributes,K(new P,t.centroid),l)):r.push(new v(s,t.attributes,null,l))}return r}function or(r,n,o=n.hasZ,e=n.hasM){return Er(r,n.rings,o,e)}function Er(r,n,o,e){const u=w(o,e),{lengths:t,coords:s}=r;let l=0;Z(r);for(const i of n){for(const c of i)for(let f=0;f<u;f++)s[l++]=c[f];t.push(i.length)}return r}const k=[],E=[];function Vr(r,n,o,e,u){k[0]=r;const[t]=er(E,k,n,o,e,u);return T(k),T(E),t}function er(r,n,o,e,u,t){if(T(r),!o){for(const s of n){const l=F(s,t);r.push(new v(null,s.attributes,null,l))}return r}switch(o){case"esriGeometryPoint":return Pr(r,n,e,u,t);case"esriGeometryMultipoint":return Zr(r,n,e,u,t);case"esriGeometryPolyline":return xr(r,n,e,u,t);case"esriGeometryPolygon":case"esriGeometryMultiPatch":return vr(r,n,e,u,t);default:L().error("convertToFeatureSet:unknown-geometry",new z("internal:geometry",`Unable to parse unknown geometry type '${o}'`)),T(r)}return r}function qr(r,n,o,e){E[0]=r,tr(k,E,n,o,e);const u=k[0];return T(k),T(E),u}function Ar(r,n,o){if(r==null)return null;const e=new P;return"hasZ"in r&&n==null&&(n=r.hasZ),"hasM"in r&&o==null&&(o=r.hasM),sr(r)?j(n??r.z!=null,o??r.m!=null)(e,r):ur(r)?or(e,r,n,o):lr(r)?rr(e,r,w(n,o)):cr(r)?W(e,r,w(n,o)):void L().error("convertFromGeometry:unknown-geometry",new z("internal:geometry",`Unable to parse unknown geometry type '${r}'`))}function Fr(r,n,o,e){const u=r&&("coords"in r?r:r.geometry);if(u==null)return null;switch(n){case"esriGeometryPoint":{let t=U;return o&&e?t=X:o?t=O:e&&(t=D),t(u)}case"esriGeometryMultipoint":return Q(u,o,e);case"esriGeometryPolyline":return $(u,o,e);case"esriGeometryPolygon":return nr(u,o,e);default:return L().error("convertToGeometry:unknown-geometry",new z("internal:geometry",`Unable to parse unknown geometry type '${n}'`)),null}}function zr(r,n){for(const o of n)r.push({attributes:o.attributes});return r}function tr(r,n,o,e,u){if(T(r),o==null)return zr(r,n);switch(o){case"esriGeometryPoint":return br(r,n,e,u);case"esriGeometryMultipoint":return Ir(r,n,e,u);case"esriGeometryPolyline":return Nr(r,n,e,u);case"esriGeometryPolygon":return kr(r,n,e,u);default:L().error("convertToFeatureSet:unknown-geometry",new z("internal:geometry",`Unable to parse unknown geometry type '${o}'`))}return r}function Cr(r){const{spatialReference:n,transform:o,fields:e,hasM:u,hasZ:t,features:s,geometryType:l,exceededTransferLimit:i,queryGeometry:c,queryGeometryType:f}=r,a={features:tr([],s,l,t,u),fields:e,geometryType:l,spatialReference:n,queryGeometry:Fr(c,f,!1,!1)};return o&&(a.transform=o),i&&(a.exceededTransferLimit=i),u&&(a.hasM=u),t&&(a.hasZ=t),a}function Or(r,n){const o=new dr,{hasM:e,hasZ:u,features:t,spatialReference:s,geometryType:l,exceededTransferLimit:i,transform:c,fields:f}=r;return f&&(o.fields=f),o.geometryType=l??null,o.spatialReference=s??null,t&&er(o.features,t,l,u,e,n),i&&(o.exceededTransferLimit=i),e&&(o.hasM=e),u&&(o.hasZ=u),c&&(o.transform=c),o}function Dr(r){const{transform:n,features:o,hasM:e,hasZ:u}=r;if(!n)return r;for(const t of o)t.geometry!=null&&J(t.geometry,t.geometry,e,u,n),t.centroid!=null&&J(t.centroid,t.centroid,e,u,n);return r.transform=null,r}function Xr(r,n){const{geometryType:o,features:e,hasM:u,hasZ:t}=n;if(!r)return n;for(let s=0;s<e.length;s++){const l=e[s],i=l.weakClone();i.geometry=new P,H(i.geometry,l.geometry,u,t,o,r),l.centroid&&(i.centroid=new P,H(i.centroid,l.centroid,u,t,"esriGeometryPoint",r)),e[s]=i}return n.transform=r,n}function H(r,n,o,e,u,t,s=o,l=e){if(Z(r),!n?.coords.length)return null;const i=A[u],{coords:c,lengths:f}=n,a=w(o,e),h=w(o&&s,e&&l),g=C(o,e,s,l);if(!f.length)return g(r.coords,c,0,0,Y(t,c[0]),_(t,c[1])),Z(r,a,0),r;let d,m,M,b,p=0,y=0,G=y;for(const N of f){if(N<i)continue;let I=0;y=G,M=d=Y(t,c[p]),b=m=_(t,c[p+1]),g(r.coords,c,y,p,M,b),I++,p+=a,y+=h;for(let x=1;x<N;x++,p+=a)M=Y(t,c[p]),b=_(t,c[p+1]),M===d&&b===m||(g(r.coords,c,y,p,M-d,b-m),y+=h,I++,d=M,m=b);I>=i&&(r.lengths.push(I),G=y)}return T(r.coords,G),r.coords.length?r:null}function jr(r,n,o,e,u,t,s=o,l=e){if(Z(r),!n?.coords.length)return null;const i=A[u],{coords:c,lengths:f}=n,a=w(o,e),h=w(o&&s,e&&l),g=C(o,e,s,l);if(!f.length)return g(r.coords,c,0,0,c[0],c[1]),Z(r,a,0),r;let d=0;const m=t*t;for(const M of f){if(M<i){d+=M*a;continue}const b=r.coords.length/h,p=d,y=d+(M-1)*a;g(r.coords,c,r.coords.length,p,c[p],c[p+1]),q(r.coords,c,a,m,g,p,y),g(r.coords,c,r.coords.length,y,c[y],c[y+1]);const G=r.coords.length/h-b;G>=i?r.lengths.push(G):T(r.coords,b*h),d+=M*a}return r.coords.length?r:null}function Lr(r,n,o,e){const u=r[n],t=r[n+1],s=r[o],l=r[o+1],i=r[e],c=r[e+1];let f=s,a=l,h=i-f,g=c-a;if(h!==0||g!==0){const d=((u-f)*h+(t-a)*g)/(h*h+g*g);d>1?(f=i,a=c):d>0&&(f+=h*d,a+=g*d)}return h=u-f,g=t-a,h*h+g*g}function q(r,n,o,e,u,t,s){let l,i=e,c=0;for(let f=t+o;f<s;f+=o)l=Lr(n,f,t,s),l>i&&(c=f,i=l);i>e&&(c-t>o&&q(r,n,o,e,u,t,c),u(r,n,r.length,c,n[c],n[c+1]),s-c>o&&q(r,n,o,e,u,c,s))}function Br(r,n,o,e){if(!n?.coords?.length)return null;const u=w(o,e);let t=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(n&&n.coords){const c=n.coords;for(let f=0;f<c.length;f+=u){const a=c[f],h=c[f+1];t=Math.min(t,a),l=Math.max(l,a),s=Math.min(s,h),i=Math.max(i,h)}}return fr(r)?ar(r,t,s,l,i):hr(t,s,l,i,r),r}function J(r,n,o,e,u){const{coords:t,lengths:s}=n,l=w(o,e);if(!t.length)return r!==n&&Z(r),r;gr(u);const{originPosition:i,scale:c,translate:f}=u,a=_r;a.originPosition=i;const h=a.scale;h[0]=c[0]??1,h[1]=-(c[1]??1),h[2]=c[2]??1,h[3]=c[3]??1;const g=a.translate;if(g[0]=f[0]??0,g[1]=f[1]??0,g[2]=f[2]??0,g[3]=f[3]??0,!s.length){for(let m=0;m<l;++m)r.coords[m]=V(a,t[m],m);return r!==n&&Z(r,l,0),r}let d=0;for(let m=0;m<s.length;m++){const M=s[m];r.lengths[m]=M;for(let y=0;y<l;++y)r.coords[d+y]=V(a,t[d+y],y);let b=r.coords[d],p=r.coords[d+1];d+=l;for(let y=1;y<M;y++,d+=l){b+=t[d]*h[0],p+=t[d+1]*h[1],r.coords[d]=b,r.coords[d+1]=p;for(let G=2;G<l;++G)r.coords[d+G]=V(a,t[d+G],G)}}return r!==n&&Z(r,t.length,s.length),r}function Hr(r,n,o,e,u,t){if(Z(r),r.lengths.push(...n.lengths),o===u&&e===t)for(let s=0;s<n.coords.length;s++)r.coords.push(n.coords[s]);else{const s=w(o,e),l=C(o,e,u,t),i=n.coords;for(let c=0;c<i.length;c+=s)l(r.coords,i,r.coords.length,c,i[c],i[c+1])}return r}function Ur(r,n,o,e){let u=0,t=r[e*n],s=r[e*(n+1)];for(let l=1;l<o;l++){const i=t+r[e*(n+l)],c=s+r[e*(n+l)+1],f=(i-t)*(c+s);t=i,s=c,u+=f}return .5*u}function Jr(r,n){const{coords:o,lengths:e}=r;let u=0,t=0;for(let s=0;s<e.length;s++){const l=e[s];t+=Ur(o,u,l,n),u+=l}return Math.abs(t)}function Yr(r,n,o,e){return r*e-o*n===0&&r*o+n*e>0}function Kr(r,n,o,e,u){const t=w(e,u);if(!r.lengths.length){if(r.coords.length<2)return null;const[a,h]=r.coords,g=R(n,a),d=S(n,h);return new P([],[g,d])}const s=new P([],[0,0]),l=A[o],i=o==="esriGeometryPolygon"||o==="esriGeometryPolyline";let c=0,f=0;for(let a=0;a<r.lengths.length;a++){const h=r.lengths[a],g=f;let d=R(n,r.coords[t*c]),m=S(n,r.coords[t*c+1]);s.coords[f++]=d,s.coords[f++]=m;let M=0,b=0,p=1;for(let y=1;y<h;y++){const G=R(n,r.coords[t*(y+c)]),N=S(n,r.coords[t*(y+c)+1]);if(G!==d||N!==m){const I=G-d,x=N-m;i&&Yr(M,b,I,x)?(s.coords[f-2]+=I,s.coords[f-1]+=x,d+=I,m+=x):(s.coords[f++]=G,s.coords[f++]=N,d=G,m=N,M=I,b=x,p+=1)}}p<l?f=g:s.lengths.push(p),c+=h}return s.lengths.length===0?null:s}function Z(r,n=0,o=0){T(r.lengths,o),T(r.coords,n)}function T(r,n=0){r.length!==n&&(r.length=n)}const _r={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};export{Q as $,$ as D,Sr as E,Hr as G,Br as M,Jr as N,nr as Q,Tr as R,_ as T,or as X,Or as a,Y as b,jr as d,Cr as f,H as g,Dr as h,Fr as l,Xr as m,Vr as o,er as r,qr as s,Er as t,Ar as u,J as w,Kr as x};
