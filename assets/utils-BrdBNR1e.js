import{eg as s}from"./index-Bkom2Sdc.js";import{e as c}from"./grouping-DJTVfo2I.js";function d(t){return s(t.frameDurations.reduce((e,r)=>e+r,0))}function f(t){const{width:e,height:r}=t,o=t.frameDurations.reverse(),a=i=>{const n=t.frameDurations.length-1-i;return t.getFrame(n)};return{frameCount:t.frameCount,duration:t.duration,frameDurations:o,getFrame:a,width:e,height:r}}function _(t,e){const{width:r,height:o,getFrame:a}=t,i=e/t.duration,n=t.frameDurations.map(m=>s(m*i));return{frameCount:t.frameCount,duration:t.duration,frameDurations:n,getFrame:a,width:r,height:o}}function F(t,e){const{width:r,height:o,getFrame:a}=t,i=t.frameDurations.slice(),n=i.shift();return i.unshift(s(n+e)),{frameCount:t.frameCount,duration:t.duration+e,frameDurations:i,getFrame:a,width:r,height:o}}function u(t,e){const{width:r,height:o,getFrame:a}=t,i=t.frameDurations.slice(),n=i.pop();return i.push(s(n+e)),{frameCount:t.frameCount,duration:t.duration+e,frameDurations:i,getFrame:a,width:r,height:o}}class l{constructor(e,r,o,a){this._animation=e,this._repeatType=o,this._onFrameData=a,this._direction=1,this._currentFrame=0,this._lastUpdated=s(0),this.timeInFrame=0,this.timeToFrame=this._animation.frameDurations[this._currentFrame];let i=0;for(;r>i;)i+=this.timeToFrame,this.nextFrame();const n=this._animation.getFrame(this._currentFrame);this._onFrameData(n)}nextFrame(){if(this._currentFrame+=this._direction,this._direction>0){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case"None":this._currentFrame-=this._direction;break;case"Loop":this._currentFrame=0;break;case"Oscillate":this._currentFrame-=this._direction,this._direction=-1}}else if(this._currentFrame===-1)switch(this._repeatType){case"None":this._currentFrame-=this._direction;break;case"Loop":this._currentFrame=this._animation.frameDurations.length-1;break;case"Oscillate":this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame],this.timeInFrame=0;const e=this._animation.getFrame(this._currentFrame);this._onFrameData(e)}update(e){const r=s(e-this._lastUpdated);this._lastUpdated=e,this._advance(r)}_advance(e){this.timeInFrame+=e,this.timeInFrame>this.timeToFrame&&this.nextFrame()}}function D(t,e){t.animationsEnabled&&e?.update(s(t.time))}function w(t,e,r,o){let a,{repeatType:i}=e;if(i==null&&(i="Loop"),e.reverseAnimation===!0&&(t=f(t)),e.duration!=null&&(t=_(t,s(1e3*e.duration))),e.repeatDelay!=null){const n=1e3*e.repeatDelay;i==="Loop"?t=u(t,s(n)):i==="Oscillate"&&(t=F(u(t,s(n/2)),s(n/2)))}if(e.startTimeOffset!=null)a=s(1e3*e.startTimeOffset);else if(e.randomizeStartTime!=null){const m=e.randomizeStartSeed!=null?e.randomizeStartSeed:82749913,h=c(r,m);a=s(h*d(t))}else a=s(0);return new l(t,a,i,o)}export{w as h,D as m};
